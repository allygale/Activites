{"version":3,"sources":["../client/js/activity-card.js"],"names":[],"mappings":"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","file":"activity-card.js","sourcesContent":["// Require react, convenience libraries and UI components\nvar React = require('react');\nvar m = require('./m.js');\nvar Card = require('./card.js');\nvar CardOptions = require('./card-options.js');\nvar AttendeesList = require('./attendees-list.js');\nvar FriendIcon = require('./friend-icon.js');\nvar Collapse = require('react-collapse');\n\n// Require core logic\nvar models = require('./models.js');\nvar swLibrary = require('./swsetup.js')\n\nvar OPTIONS = {\n  edit: 0,\n  attend: 1,\n  undoAttend: 2\n};\n\nvar ActivityCard = React.createClass({\n  getCardsOption: function () {\n    if (this.props.activity.is_creator) {\n      return OPTIONS.edit;\n    } else if (this.props.activity.is_attending) {\n      return OPTIONS.undoAttend;\n    } else {\n      return OPTIONS.attend;\n    }\n  },\n  // E.g. \"tomorrow at 2pm\", or \"on Wednesday at 8pm\"\n  // TODO: Render 0AM as Midnight\n  getDateString: function () {\n    var today = Date.today();\n    var tomorrow = (Date.today()).add(1).days();\n    // This is the full date + time\n    var dateTime = this.props.activity.start_time;\n    // This is a copy of the date (time stripped) used for date comparison\n    var dateCopy = dateTime.clone().clearTime();\n    var str = '';\n    if (today.equals(dateCopy)) {\n      str += 'today ';\n    } else if (tomorrow.equals(dateCopy)) {\n      str += 'tomorrow ';\n    } else {\n      str += 'on ' + dateTime.toString('dddd dS') + ' ';\n    }\n    str += 'at ' + dateTime.toString('h');\n    var minutes = dateTime.toString('mm');\n    if (minutes !== '00') {\n      str += ':' + minutes;\n    }\n    str += dateTime.toString('tt').toLowerCase();\n    return str;\n  },\n  // Toggle the selected state\n  handleCardClick: function (e) {\n    this.props.onClick(this.props.activity);\n  },\n  handleEditClick: function (e) {\n    // Prevent default so we don't also fire a click on the card\n    e.stopPropagation();\n    this.props.onEditClick(this.props.activity);\n  },\n  handleAttendClick: function (e) {\n    // Prevent default so we don't also fire a click on the card\n    e.stopPropagation();\n    this.props.onAttendClick(this.props.activity);\n  },\n  handleUnattendClick: function (e) {\n    // Prevent default so we don't also fire a click on the card\n    e.stopPropagation();\n    this.props.onUnattendClick(this.props.activity);\n  },\n  render: function() {\n    var optionString = ['Edit', 'Go along', 'Cancel attending'][this.getCardsOption()];\n    var onOptionClick = (() => {\n      switch(this.getCardsOption()) {\n        case OPTIONS.edit:\n          return this.handleEditClick;\n          break;\n        case OPTIONS.attend:\n          return this.handleAttendClick;\n          break;\n        case OPTIONS.undoAttend:\n          return this.handleUnattendClick;\n          break;\n      }\n    })();\n\n    return (\n      <Card backgroundColor={this.props.activity.is_attending ? '#cdf9c9' : undefined} onClick={this.handleCardClick}>\n        <div style={{padding: '24px'}}>\n          <FriendIcon thumbnail={this.props.activity.thumbnail}/>\n          {/* This forces the title to not wrap around the bottom of the icon */}\n          <div style={{overflow: 'hidden'}}>\n            { /* Title section */ }\n            {\n              this.props.activity.is_creator ? (\n                <span><b>You</b> are </span>\n              ) : (\n                <span><b>{this.props.activity.creator_name}</b> is </span>\n              )\n            }\n            <b>{this.props.activity.title}</b> {this.getDateString()}\n            {\n              /* Description and attendees */\n              <Collapse isOpened={this.props.selected}>\n                <div style={{paddingTop: '16px'}}>\n                  { /* TODO: Tidy up this crap! */ }\n                  {\n                    this.props.activity.description !== '' ? (\n                      <div>\n                        <p><b>Description</b></p>\n                        { /* whiteSpace ensures we retain line breaks from the text.\n                          userSelect enables selection for copy pasting */ }\n                        <p style={{whiteSpace: 'pre-wrap', WebkitUserSelect: 'text'}}>\n                          {this.props.activity.description}\n                        </p>\n                      </div>\n                    ) : null\n                  }\n                  {\n                    (this.props.activity.description !== '' && this.props.activity.attendees.length > 0) ?\n                      <br /> : null\n                  }\n                  <AttendeesList attendees={this.props.activity.attendees}/>\n                  {\n                    (this.props.activity.description == '' && this.props.activity.attendees.length == 0) ? (\n                      <p>No more information available for this plan</p>\n                    ) : null\n                  }\n                </div>\n              </Collapse>\n            }\n          </div>\n        </div>\n        <CardOptions\n          options={[{label: optionString, onClick: onOptionClick}]}\n        />\n      </Card>\n    );\n  }\n});\n\nmodule.exports = ActivityCard;\n"]}